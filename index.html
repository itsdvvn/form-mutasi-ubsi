<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Pengajuan Mutasi UBSI</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel for JSX -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        @media print {
            .no-print { display: none !important; }
            .print-area { 
                box-shadow: none !important; 
                margin: 0 !important; 
                padding: 0 !important;
                width: 100% !important;
            }
            @page { margin: 20mm; size: A4; }
        }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // Komponen Field di luar App agar stabil dan tidak kehilangan fokus
        const Field = React.memo(({ label, name, value, onChange, placeholder, type = "text", full = false }) => (
            <div className={full ? "col-span-full space-y-1" : "space-y-1"}>
                <label className="text-xs font-bold text-slate-600 uppercase">{label}</label>
                <input 
                    name={name} 
                    type={type}
                    value={value} 
                    onChange={onChange} 
                    placeholder={placeholder}
                    className="w-full p-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm transition-all"
                />
            </div>
        ));

        const App = () => {
            const [formData, setFormData] = useState({
                tanggal: new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' }),
                nama: '',
                nim: '',
                kelas: '',
                email: '',
                noHp: '',
                periodeAsal: 'Maret 2025',
                kampusAsal: '',
                jenjangAsal: 'S1',
                prodiAsal: '',
                waktuAsal: '',
                alasan: '',
                periodeTujuan: 'Maret 2025',
                kampusTujuan: '',
                jenjangTujuan: 'S1',
                prodiTujuan: '',
                waktuTujuan: '',
            });

            // Hanya jalankan createIcons sekali saat mount
            useEffect(() => {
                lucide.createIcons();
            }, []);

            const handleChange = useCallback((e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            }, []);

            const handlePrint = () => window.print();

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-7xl mx-auto flex flex-col lg:flex-row gap-8">
                        
                        {/* INPUT PANEL */}
                        <div className="w-full lg:w-5/12 space-y-6 no-print">
                            <div className="bg-white p-6 rounded-2xl shadow-xl border border-slate-200">
                                <div className="flex items-center gap-3 mb-6">
                                    <div className="p-2 bg-blue-100 text-blue-600 rounded-lg">
                                        <i data-lucide="file-text"></i>
                                    </div>
                                    <h1 className="text-xl font-bold text-slate-800">Data Mutasi</h1>
                                </div>

                                <div className="space-y-6">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <Field label="Nama Lengkap" name="nama" value={formData.nama} onChange={handleChange} placeholder="Contoh: Muhammad..." />
                                        <Field label="NIM" name="nim" value={formData.nim} onChange={handleChange} placeholder="1221xxxx" />
                                        <Field label="Kelas" name="kelas" value={formData.kelas} onChange={handleChange} placeholder="12.4A.01" />
                                        <Field label="No HP" name="noHp" value={formData.noHp} onChange={handleChange} placeholder="0812xxx" />
                                        <Field label="Email" name="email" value={formData.email} onChange={handleChange} type="email" placeholder="email@gmail.com" />
                                        <div className="space-y-1">
                                            <label className="text-xs font-bold text-slate-600 uppercase">Periode Asal</label>
                                            <select name="periodeAsal" value={formData.periodeAsal} onChange={handleChange} className="w-full p-2 border border-slate-300 rounded-lg outline-none text-sm bg-white">
                                                <option value="Maret 2025">Maret 2025</option>
                                                <option value="September 2025">September 2025</option>
                                            </select>
                                        </div>
                                        <Field label="Kampus Asal" name="kampusAsal" value={formData.kampusAsal} onChange={handleChange} placeholder="UBSI Cengkareng" full />
                                        <div className="space-y-1">
                                            <label className="text-xs font-bold text-slate-600 uppercase">Jenjang</label>
                                            <div className="flex gap-4 p-2">
                                                <label className="flex items-center gap-2 text-sm cursor-pointer"><input type="radio" name="jenjangAsal" value="S1" checked={formData.jenjangAsal === 'S1'} onChange={handleChange} /> S1</label>
                                                <label className="flex items-center gap-2 text-sm cursor-pointer"><input type="radio" name="jenjangAsal" value="D3" checked={formData.jenjangAsal === 'D3'} onChange={handleChange} /> D3</label>
                                            </div>
                                        </div>
                                        <Field label="Prodi Asal" name="prodiAsal" value={formData.prodiAsal} onChange={handleChange} placeholder="Sistem Informasi" />
                                        <Field label="Waktu Kuliah Asal" name="waktuAsal" value={formData.waktuAsal} onChange={handleChange} placeholder="Pagi / Malam" />
                                    </div>

                                    <div className="space-y-1">
                                        <label className="text-xs font-bold text-slate-600 uppercase">Alasan Mutasi</label>
                                        <textarea 
                                            name="alasan" 
                                            value={formData.alasan} 
                                            onChange={handleChange} 
                                            className="w-full p-2 border border-slate-300 rounded-lg outline-none text-sm h-20 transition-all focus:ring-2 focus:ring-blue-500" 
                                            placeholder="Sebutkan alasan Anda..."
                                        ></textarea>
                                    </div>

                                    <div className="bg-slate-50 p-4 rounded-xl border border-slate-100 space-y-4">
                                        <h3 className="font-bold text-slate-700 text-sm flex items-center gap-2">
                                            <i data-lucide="map-pin" className="w-4 h-4"></i> Data Kampus Tujuan
                                        </h3>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <Field label="Kampus Tujuan" name="kampusTujuan" value={formData.kampusTujuan} onChange={handleChange} placeholder="UBSI Margonda" />
                                            <Field label="Prodi Tujuan" name="prodiTujuan" value={formData.prodiTujuan} onChange={handleChange} placeholder="Sistem Informasi" />
                                            <Field label="Waktu Kuliah" name="waktuTujuan" value={formData.waktuTujuan} onChange={handleChange} placeholder="Malam" />
                                            <div className="space-y-1">
                                                <label className="text-xs font-bold text-slate-600 uppercase">Periode</label>
                                                <select name="periodeTujuan" value={formData.periodeTujuan} onChange={handleChange} className="w-full p-2 border border-slate-300 rounded-lg outline-none text-sm bg-white">
                                                    <option value="Maret 2025">Maret 2025</option>
                                                    <option value="September 2025">September 2025</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <button onClick={handlePrint} className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2">
                                        <i data-lucide="printer"></i> Cetak ke PDF
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* PREVIEW PANEL */}
                        <div className="w-full lg:w-7/12 flex flex-col items-center">
                            <div className="print-area w-full max-w-[210mm] bg-white shadow-2xl p-[15mm] md:p-[20mm] min-h-[297mm] text-[11pt] leading-snug text-black">
                                <div className="text-right mb-10">
                                    Jakarta, {formData.tanggal}
                                </div>

                                <div className="mb-8">
                                    Kepada YTH.<br />
                                    <span className="font-bold">Ketua Penerimaan Mahasiswa Baru</span><br />
                                    Universitas Bina Sarana Informatika<br />
                                    Di Tempat
                                </div>

                                <div className="font-bold mb-8 uppercase underline decoration-1 underline-offset-4">
                                    Perihal : Pengajuan Mutasi
                                </div>

                                <p className="mb-6 text-justify">
                                    Saya yang bertanda tangan dibawah ini, telah terdaftar di Universitas Bina Sarana Informatika. Dan Akan mengajukan mutasi. Adapun data saya sebagai berikut :
                                </p>

                                <table className="w-full mb-8">
                                    <tbody>
                                        {[
                                            ['Nama', formData.nama],
                                            ['NIM', formData.nim],
                                            ['Kelas', formData.kelas],
                                            ['Email', formData.email],
                                            ['No Handphone', formData.noHp],
                                            ['Periode kuliah', formData.periodeAsal, true],
                                            ['Kampus UBSI cabang', formData.kampusAsal],
                                            ['Jenjang Study', formData.jenjangAsal, true],
                                            ['Program Studi', formData.prodiAsal],
                                            ['Waktu Kuliah', formData.waktuAsal]
                                        ].map(([label, val, bold], idx) => (
                                            <tr key={idx}>
                                                <td className="w-[200px] py-1 align-top">{label}</td>
                                                <td className={`py-1 align-top ${bold ? 'font-bold' : ''}`}>: {val || '.............................................................'}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>

                                <p className="mb-6">
                                    Dengan ini mengajukan perpindahan / mutasi dikarenakan <strong>{formData.alasan || '.........................................'}</strong>. Adapun data pengajuan mutasi sebagai berikut :
                                </p>

                                <div className="font-bold underline mb-4 uppercase">Mengajukan Pindah ke :</div>
                                <table className="w-full mb-10">
                                    <tbody>
                                        {[
                                            ['Periode kuliah', formData.periodeTujuan, true],
                                            ['Kampus UBSI cabang', formData.kampusTujuan],
                                            ['Jenjang Study', formData.jenjangTujuan, true],
                                            ['Program Studi', formData.prodiTujuan],
                                            ['Waktu Kuliah', formData.waktuTujuan]
                                        ].map(([label, val, bold], idx) => (
                                            <tr key={idx}>
                                                <td className="w-[200px] py-1 align-top">{label}</td>
                                                <td className={`py-1 align-top ${bold ? 'font-bold' : ''}`}>: {val || '.............................................................'}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>

                                <p className="mb-12">
                                    Demikian surat pengajuan mutasi ini dibuat. Tanpa ada unsur paksaan dari pihak manapun. Atas perhatian dan kebijaksanaannya. Kami mengucapkan banyak terima kasih.
                                </p>

                                <div className="mt-10">
                                    <div>Hormat Saya</div>
                                    <div className="h-24"></div>
                                    <div className="font-bold underline uppercase">
                                        ( {formData.nama || 'Nama Lengkap'} )
                                    </div>
                                </div>
                            </div>
                            <p className="no-print mt-4 text-slate-400 text-xs italic">Tampilan di atas adalah simulasi ukuran kertas A4</p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
